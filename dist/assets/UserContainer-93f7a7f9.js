import{_ as D,l as A,m as G,o as M,q as L,t as H,u as J,v as B,x as N,y as X,z as Y,A as O,S as Z,B as I,C as K,D as ee,E as te,F as re,G as se,H as ne,I as ie,J as S,L as d,M as ue,N as U,O as Q,P as E,Q as ae,R as oe,T as ce,U as le,V as he,W as de,X as fe,Y as pe,Z as j}from"./index-6060e226.js";var ve=function(c){D(a,c);function a(r,t){var e;return e=c.call(this)||this,e.client=r,e.options=t,e.trackedProps=[],e.selectError=null,e.bindMethods(),e.setOptions(t),e}var n=a.prototype;return n.bindMethods=function(){this.remove=this.remove.bind(this),this.refetch=this.refetch.bind(this)},n.onSubscribe=function(){this.listeners.length===1&&(this.currentQuery.addObserver(this),V(this.currentQuery,this.options)&&this.executeFetch(),this.updateTimers())},n.onUnsubscribe=function(){this.listeners.length||this.destroy()},n.shouldFetchOnReconnect=function(){return T(this.currentQuery,this.options,this.options.refetchOnReconnect)},n.shouldFetchOnWindowFocus=function(){return T(this.currentQuery,this.options,this.options.refetchOnWindowFocus)},n.destroy=function(){this.listeners=[],this.clearTimers(),this.currentQuery.removeObserver(this)},n.setOptions=function(t,e){var i=this.options,s=this.currentQuery;if(this.options=this.client.defaultQueryObserverOptions(t),typeof this.options.enabled<"u"&&typeof this.options.enabled!="boolean")throw new Error("Expected enabled to be a boolean");this.options.queryKey||(this.options.queryKey=i.queryKey),this.updateQuery();var u=this.hasListeners();u&&$(this.currentQuery,s,this.options,i)&&this.executeFetch(),this.updateResult(e),u&&(this.currentQuery!==s||this.options.enabled!==i.enabled||this.options.staleTime!==i.staleTime)&&this.updateStaleTimeout();var o=this.computeRefetchInterval();u&&(this.currentQuery!==s||this.options.enabled!==i.enabled||o!==this.currentRefetchInterval)&&this.updateRefetchInterval(o)},n.getOptimisticResult=function(t){var e=this.client.defaultQueryObserverOptions(t),i=this.client.getQueryCache().build(this.client,e);return this.createResult(i,e)},n.getCurrentResult=function(){return this.currentResult},n.trackResult=function(t,e){var i=this,s={},u=function(l){i.trackedProps.includes(l)||i.trackedProps.push(l)};return Object.keys(t).forEach(function(o){Object.defineProperty(s,o,{configurable:!1,enumerable:!0,get:function(){return u(o),t[o]}})}),(e.useErrorBoundary||e.suspense)&&u("error"),s},n.getNextResult=function(t){var e=this;return new Promise(function(i,s){var u=e.subscribe(function(o){o.isFetching||(u(),o.isError&&(t!=null&&t.throwOnError)?s(o.error):i(o))})})},n.getCurrentQuery=function(){return this.currentQuery},n.remove=function(){this.client.getQueryCache().remove(this.currentQuery)},n.refetch=function(t){return this.fetch(A({},t,{meta:{refetchPage:t==null?void 0:t.refetchPage}}))},n.fetchOptimistic=function(t){var e=this,i=this.client.defaultQueryObserverOptions(t),s=this.client.getQueryCache().build(this.client,i);return s.fetch().then(function(){return e.createResult(s,i)})},n.fetch=function(t){var e=this;return this.executeFetch(t).then(function(){return e.updateResult(),e.currentResult})},n.executeFetch=function(t){this.updateQuery();var e=this.currentQuery.fetch(this.options,t);return t!=null&&t.throwOnError||(e=e.catch(G)),e},n.updateStaleTimeout=function(){var t=this;if(this.clearStaleTimeout(),!(M||this.currentResult.isStale||!L(this.options.staleTime))){var e=H(this.currentResult.dataUpdatedAt,this.options.staleTime),i=e+1;this.staleTimeoutId=setTimeout(function(){t.currentResult.isStale||t.updateResult()},i)}},n.computeRefetchInterval=function(){var t;return typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.currentResult.data,this.currentQuery):(t=this.options.refetchInterval)!=null?t:!1},n.updateRefetchInterval=function(t){var e=this;this.clearRefetchInterval(),this.currentRefetchInterval=t,!(M||this.options.enabled===!1||!L(this.currentRefetchInterval)||this.currentRefetchInterval===0)&&(this.refetchIntervalId=setInterval(function(){(e.options.refetchIntervalInBackground||J.isFocused())&&e.executeFetch()},this.currentRefetchInterval))},n.updateTimers=function(){this.updateStaleTimeout(),this.updateRefetchInterval(this.computeRefetchInterval())},n.clearTimers=function(){this.clearStaleTimeout(),this.clearRefetchInterval()},n.clearStaleTimeout=function(){this.staleTimeoutId&&(clearTimeout(this.staleTimeoutId),this.staleTimeoutId=void 0)},n.clearRefetchInterval=function(){this.refetchIntervalId&&(clearInterval(this.refetchIntervalId),this.refetchIntervalId=void 0)},n.createResult=function(t,e){var i=this.currentQuery,s=this.options,u=this.currentResult,o=this.currentResultState,l=this.currentResultOptions,p=t!==i,y=p?t.state:this.currentQueryInitialState,m=p?this.currentResult:this.previousQueryResult,h=t.state,b=h.dataUpdatedAt,P=h.error,x=h.errorUpdatedAt,C=h.isFetching,f=h.status,_=!1,w=!1,v;if(e.optimisticResults){var k=this.hasListeners(),q=!k&&V(t,e),W=k&&$(t,i,e,s);(q||W)&&(C=!0,b||(f="loading"))}if(e.keepPreviousData&&!h.dataUpdateCount&&(m!=null&&m.isSuccess)&&f!=="error")v=m.data,b=m.dataUpdatedAt,f=m.status,_=!0;else if(e.select&&typeof h.data<"u")if(u&&h.data===(o==null?void 0:o.data)&&e.select===this.selectFn)v=this.selectResult;else try{this.selectFn=e.select,v=e.select(h.data),e.structuralSharing!==!1&&(v=B(u==null?void 0:u.data,v)),this.selectResult=v,this.selectError=null}catch(g){N().error(g),this.selectError=g}else v=h.data;if(typeof e.placeholderData<"u"&&typeof v>"u"&&(f==="loading"||f==="idle")){var R;if(u!=null&&u.isPlaceholderData&&e.placeholderData===(l==null?void 0:l.placeholderData))R=u.data;else if(R=typeof e.placeholderData=="function"?e.placeholderData():e.placeholderData,e.select&&typeof R<"u")try{R=e.select(R),e.structuralSharing!==!1&&(R=B(u==null?void 0:u.data,R)),this.selectError=null}catch(g){N().error(g),this.selectError=g}typeof R<"u"&&(f="success",v=R,w=!0)}this.selectError&&(P=this.selectError,v=this.selectResult,x=Date.now(),f="error");var z={status:f,isLoading:f==="loading",isSuccess:f==="success",isError:f==="error",isIdle:f==="idle",data:v,dataUpdatedAt:b,error:P,errorUpdatedAt:x,failureCount:h.fetchFailureCount,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>y.dataUpdateCount||h.errorUpdateCount>y.errorUpdateCount,isFetching:C,isRefetching:C&&f!=="loading",isLoadingError:f==="error"&&h.dataUpdatedAt===0,isPlaceholderData:w,isPreviousData:_,isRefetchError:f==="error"&&h.dataUpdatedAt!==0,isStale:F(t,e),refetch:this.refetch,remove:this.remove};return z},n.shouldNotifyListeners=function(t,e){if(!e)return!0;var i=this.options,s=i.notifyOnChangeProps,u=i.notifyOnChangePropsExclusions;if(!s&&!u||s==="tracked"&&!this.trackedProps.length)return!0;var o=s==="tracked"?this.trackedProps:s;return Object.keys(t).some(function(l){var p=l,y=t[p]!==e[p],m=o==null?void 0:o.some(function(b){return b===l}),h=u==null?void 0:u.some(function(b){return b===l});return y&&!h&&(!o||m)})},n.updateResult=function(t){var e=this.currentResult;if(this.currentResult=this.createResult(this.currentQuery,this.options),this.currentResultState=this.currentQuery.state,this.currentResultOptions=this.options,!X(this.currentResult,e)){var i={cache:!0};(t==null?void 0:t.listeners)!==!1&&this.shouldNotifyListeners(this.currentResult,e)&&(i.listeners=!0),this.notify(A({},i,t))}},n.updateQuery=function(){var t=this.client.getQueryCache().build(this.client,this.options);if(t!==this.currentQuery){var e=this.currentQuery;this.currentQuery=t,this.currentQueryInitialState=t.state,this.previousQueryResult=this.currentResult,this.hasListeners()&&(e==null||e.removeObserver(this),t.addObserver(this))}},n.onQueryUpdate=function(t){var e={};t.type==="success"?e.onSuccess=!0:t.type==="error"&&!Y(t.error)&&(e.onError=!0),this.updateResult(e),this.hasListeners()&&this.updateTimers()},n.notify=function(t){var e=this;O.batch(function(){t.onSuccess?(e.options.onSuccess==null||e.options.onSuccess(e.currentResult.data),e.options.onSettled==null||e.options.onSettled(e.currentResult.data,null)):t.onError&&(e.options.onError==null||e.options.onError(e.currentResult.error),e.options.onSettled==null||e.options.onSettled(void 0,e.currentResult.error)),t.listeners&&e.listeners.forEach(function(i){i(e.currentResult)}),t.cache&&e.client.getQueryCache().notify({query:e.currentQuery,type:"observerResultsUpdated"})})},a}(Z);function ye(c,a){return a.enabled!==!1&&!c.state.dataUpdatedAt&&!(c.state.status==="error"&&a.retryOnMount===!1)}function V(c,a){return ye(c,a)||c.state.dataUpdatedAt>0&&T(c,a,a.refetchOnMount)}function T(c,a,n){if(a.enabled!==!1){var r=typeof n=="function"?n(c):n;return r==="always"||r!==!1&&F(c,a)}return!1}function $(c,a,n,r){return n.enabled!==!1&&(c!==a||r.enabled===!1)&&(!n.suspense||c.state.status!=="error")&&F(c,n)}function F(c,a){return c.isStaleByTime(a.staleTime)}function Re(){var c=!1;return{clearReset:function(){c=!1},reset:function(){c=!0},isReset:function(){return c}}}var me=I.createContext(Re()),be=function(){return I.useContext(me)};function Ie(c,a){var n=I.useRef(!1),r=I.useState(0),t=r[1],e=K(),i=be(),s=e.defaultQueryObserverOptions(c);s.optimisticResults=!0,s.onError&&(s.onError=O.batchCalls(s.onError)),s.onSuccess&&(s.onSuccess=O.batchCalls(s.onSuccess)),s.onSettled&&(s.onSettled=O.batchCalls(s.onSettled)),s.suspense&&(typeof s.staleTime!="number"&&(s.staleTime=1e3),s.cacheTime===0&&(s.cacheTime=1)),(s.suspense||s.useErrorBoundary)&&(i.isReset()||(s.retryOnMount=!1));var u=I.useState(function(){return new a(e,s)}),o=u[0],l=o.getOptimisticResult(s);if(I.useEffect(function(){n.current=!0,i.clearReset();var p=o.subscribe(O.batchCalls(function(){n.current&&t(function(y){return y+1})}));return o.updateResult(),function(){n.current=!1,p()}},[i,o]),I.useEffect(function(){o.setOptions(s,{listeners:!1})},[s,o]),s.suspense&&l.isLoading)throw o.fetchOptimistic(s).then(function(p){var y=p.data;s.onSuccess==null||s.onSuccess(y),s.onSettled==null||s.onSettled(y,null)}).catch(function(p){i.clearReset(),s.onError==null||s.onError(p),s.onSettled==null||s.onSettled(void 0,p)});if(l.isError&&!i.isReset()&&!l.isFetching&&ee(s.suspense,s.useErrorBoundary,[l.error,o.getCurrentQuery()]))throw l.error;return s.notifyOnChangeProps==="tracked"&&(l=o.trackResult(l,s)),l}function Se(c,a,n){var r=te(c,a,n);return Ie(r,ve)}const ge=()=>{const c=K(),{successToast:a}=re(),{setLoading:n}=se();return ne({mutationFn:r=>ie(r),onMutate:()=>{n(!0)},onError:async r=>{console.log(r)},onSuccess:async r=>{a(`Success Update User ${r}`),c.invalidateQueries({queryKey:["users"]})},onSettled:()=>{n(!1)}})},Qe=({isOpen:c,data:a,onDidDismiss:n})=>{const[r,t]=S.useState({}),{mutate:e}=ge(),i=(u,o)=>{t(l=>({...l,[u]:o}))},s=u=>{u.preventDefault(),e(r),n()};return S.useEffect(()=>{a&&t({id:a.id,username:a.username,password:a.password,name:a.name,isAdmin:a.isAdmin})},[a]),d(ue,{title:"Update User",isOpen:c,onDidDismiss:n,children:U("form",{onSubmit:s,children:[d(Q,{children:d(E,{type:"text",label:"Id",labelPlacement:"floating",value:r==null?void 0:r.id,onIonInput:u=>i("id",u.detail.value),disabled:!0})}),d(Q,{children:d(E,{type:"text",label:"Username",labelPlacement:"floating",value:r==null?void 0:r.username,onIonInput:u=>i("username",u.detail.value)})}),d(Q,{children:d(E,{type:"password",label:"Password",labelPlacement:"floating",value:r==null?void 0:r.password,onIonInput:u=>i("password",u.detail.value)})}),d(Q,{children:d(E,{type:"text",label:"Name",labelPlacement:"floating",value:r==null?void 0:r.name,onIonInput:u=>i("name",u.detail.value)})}),d(Q,{children:d(ae,{checked:r==null?void 0:r.isAdmin,onIonChange:u=>i("isAdmin",u.detail.checked),children:"Is Admin"})}),d(oe,{type:"submit",expand:"block",children:"Submit"})]})})},Oe=S.lazy(()=>ce(()=>import("./TableUser-1a329bc8.js"),["assets/TableUser-1a329bc8.js","assets/index-6060e226.js","assets/index-7e396d3b.css"])),Ce=()=>{const c=S.useCallback(async()=>await le(),[]),{data:a,refetch:n}=Se(["user"],c),[r,t]=S.useState(),[e,i]=S.useState(!1),s=async o=>{n(),o.detail.complete()},u=o=>{t(o),i(!0)};return U(he,{children:[U(de,{title:"Data Users",children:[d(fe,{slot:"fixed",onIonRefresh:s,children:d(pe,{})}),d(S.Suspense,{fallback:d(j,{name:"crescent"}),children:a?d(Oe,{data:a,handleClickBtnEdit:o=>u(o)}):d(j,{name:"crescent"})})]}),d(Qe,{isOpen:e,data:r,onDidDismiss:()=>i(!1)})]})};export{Ce as default};
